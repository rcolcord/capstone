## Predicting photo-voltaic solar power generation

Robert Colcord

### Executive summary
Solar energy is going to be a cornerstone of the future clean energy grid. Solar power is inherently intermittent, thus the ability to predict power production from a solar panel system will be extremely important. Machine learning models can be used to make these predictions.

### Rationale
The ability to make predictions about the power that can be generated from solar panel systems will be critical for all stakeholders in the future clean energy grid. It will enable producers and utilites to provide the correct mix of energy sources on a daily basis, ensuring stability and resilience during peak hours. For markets and consumers, it will inform prices and optimal usage times. We can use regression techniques to predict the power generated using measurable information from the solar panel systems, such as location, orientation, and meteorological data.

### Research Question
Can we predict the power generated by a photo-voltaic solar panel system?

### Data Sources
The data contains 4213 samples from a solar power plant. The sample features contain information about the positioning of the panels and meteorological information. The features are labeled as follows:
- temperature_2_m_above_gnd
- relative_humidity_2_m_above_gnd Using
- mean_sea_level_pressure_MSL
- total_precipitation_sfc
- snowfall_amount_sfc
- total_cloud_cover_sfc
- high_cloud_cover_high_cld_lay
- medium_cloud_cover_mid_cld_lay
- low_cloud_cover_low_cld_lay
- shortwave_radiation_backwards_sfc
- wind_speed_10_m_above_gnd
- wind_direction_10_m_above_gnd
- wind_speed_80_m_above_gnd
- wind_direction_80_m_above_gnd
- wind_speed_900_mb
- wind_direction_900_mb
- wind_gust_10_m_above_gnd
- angle_of_incidence
- zenith
- azimuth

The output data is the power generated by the panels in kilowatts.

The data can be found here:
https://www.kaggle.com/datasets/stucom/solar-energy-power-generation-dataset/data

### Methodology
#### Data Processing
Since this dataset contains only numeric values and no missing entries, preprocessing is incredibly straightforward and simple. All that is needed is standard scaling of the feature data.

#### Modeling
This is a classic prediction problem using numeric inputs, so we will model using various forms of regression:
- Linear Regression
- Ridge Regression
- Lasso Regression
- Linear Regression with Forward Feature Selection
- Linear Regression with Lasso Feature Selection
- SVM Regression

The use of these regression algorithms also makes the task of understanding the impact of various input features very easy - we simply need to examine the feature coefficients produced in order to gain insight into which features have the biggest impact on power generation.

Train and test sets will be generated using an 80/20 split. GridSearchCV will be used to determine the optimal hyperparameters for each model - see the linked Jupyter notebook linked at the bottom of this document for specifics on the parameters searched. Mean squared error will be the metric used to evaluate performance. MSE on both train and test sets will be recorded. In addition, training time for the best model will be measured and recorded.

### Results

![Results-Dataframe.png](https://github.com/rcolcord/capstone/blob/main/images/results.png)

![Model-Scores.png](https://github.com/rcolcord/capstone/blob/main/images/test_mse.png)

All models tested performed significantly better than the baseline model which produced a MSE of 913608.02, and they all performed comparably. Ridge Regression was the best performing model with a Test MSE of 252855.85 while Linear Regression with Forward Feature Selection performed the worse with a Test MSE of 266379.39. Despite the very similar performances among the models, there is some differentiation between them in terms of overfitting and training times.

![Model-Scores.png](https://github.com/rcolcord/capstone/blob/main/images/overfit.png)

Many of the models appear to show overfitting, as demonstrated by the difference between training and test MSE. The most egregious overfitting model appears to be Linear Regression with Forward Feature Selection, followed by Lasso Regression, and Ridge Regression. Linear Regression, Linear Regression with Lasso Feature Selection, and SVM Regression do not appear to show overfitting. Linear Regression and Linear Regression with Lasso Feature Selection have negligible differences between train and test MSE.

![Model-Scores.png](https://github.com/rcolcord/capstone/blob/main/images/train_time.png)

Linear Regression and Linear Regression with Lasso Feature Selection had the lowest training times. Every other model has a training time that is about an order of magnitude longer, if not more. 
Notably, Linear Regression and Linear Regression with Lasso Feature Selection also selected models with the polynomial degree hyperparameter equal to 1, likely contributing to the low training time, and making these the most interpretable models by examining linear feature coefficients.

Given all of these factors, it would appear that Linear Regression and Linear Regression w/ Lasso are the most optimal models. All of the models performed about the same on the test set, but these show the least overfitting and lowest training times.

#### Features

Examining the feature coefficients of the best performing models can provide insight into which features are most important for predicting the power generated by a solar panel system. The feature coefficients for the best models seem to consistently show that the positioning of the panel - angle of incidence, zenith, azimuth - has the greatest impact on power generated. This makes complete sense, as sunlight needs to be falling on the face of the panel in order to generate power. Backwards shortwave radiation seems to be very important too, which also makes perfect sense; this is a measure of visible spectrum radiation - in other words, panels that are located in areas of high sunlight generate the most power. In contrast, measures of snowfall and precipitation seem to have the least impact on the power generated, while other measures of meteorological conditions, such as wind speed, wind direction, and cloud cover, seem to fall somewhere in the middle. Mean sea level pressure appears to be more important than these factors, but less important than the position and radiation factors.

Put together, this would seem to indicate that the location of the panels in high-sunlight areas and the correct positioning of the panels to receive direct sunlight are far more important in generating power than daily weather variations.

### Next steps
Next steps generally fall within two buckets - practical application, and further model development.

In terms of practical application, the best model(s) here can be used to predict power output for the solar panels in the system this dataset was built upon. Further, the information contained within the models can be used to reverse engineer the optimal positioning of new panels installed in this system. Emphasis should be placed on the orientation and placement of the panels, as these were the most determinative features in the data.

The next step in model development might include a number of things. More data should be sought to test and potentially differentiate more between the models. Neural networks might be explored, as they typically require more data than was used here. In addition, ensemble techniques might be explored for balancing the strengths and weaknesses of all models developed.

### Outline of project

- [https://github.com/rcolcord/capstone/blob/main/capstone-notebook.ipynb]()


#### Contact and Further Information
rwcolcord@gmail.com
